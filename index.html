<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Carteira Digital de Criptomoedas - Gerencie seus ativos digitais">
    <meta name="keywords" content="carteira, criptomoedas, ethereum, bitcoin, blockchain">
    <meta property="og:title" content="CryptoWallet - Sua Carteira Digital">
    <meta property="og:description" content="Gerencie suas criptomoedas com segurança">
    <meta name="twitter:title" content="CryptoWallet - Carteira Digital">
    <meta name="twitter:description" content="Plataforma segura para criptomoedas">
    <title>CryptoWallet - Sua Carteira Digital</title>
    
    <script crossorigin src="https://resource.trickle.so/vendor_lib/unpkg/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://resource.trickle.so/vendor_lib/unpkg/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://resource.trickle.so/vendor_lib/unpkg/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://resource.trickle.so/vendor_lib/unpkg/lucide-static@0.516.0/font/lucide.css" rel="stylesheet">
    
    <style type="text/tailwindcss">
        @layer base {
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 25%, #8b5cf6 50%, #ec4899 100%);
                min-height: 100vh;
                color: #ffffff;
            }
            
            :root {
                --primary-color: #3b82f6;
                --secondary-color: #8b5cf6;
                --success-color: #10b981;
                --danger-color: #ef4444;
                --warning-color: #f59e0b;
            }
        }
        
        @layer utilities {
            .glass-card {
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(20px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 16px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            }
            
            .wallet-card {
                background: linear-gradient(135deg, rgba(59, 130, 246, 0.3) 0%, rgba(139, 92, 246, 0.3) 100%);
                border: 1px solid rgba(255, 255, 255, 0.2);
                border-radius: 12px;
                transition: all 0.3s ease;
            }
            
            .wallet-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 40px rgba(59, 130, 246, 0.4);
            }
            
            .price-widget {
                background: rgba(0, 0, 0, 0.3);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // Wallet Service Functions
        function generatePrivateKey() {
            const chars = '0123456789abcdef';
            let result = '0x';
            for (let i = 0; i < 64; i++) {
                result += chars[Math.floor(Math.random() * chars.length)];
            }
            return result;
        }

        function deriveAddress(privateKey) {
            const chars = '0123456789abcdef';
            let address = '0x';
            for (let i = 0; i < 40; i++) {
                address += chars[Math.floor(Math.random() * chars.length)];
            }
            return address;
        }

        function isValidPrivateKey(privateKey) {
            return privateKey && privateKey.length === 66 && privateKey.startsWith('0x');
        }

        function isValidAddress(address) {
            return address && address.length === 42 && address.startsWith('0x');
        }

        async function createWallet(password) {
            const privateKey = generatePrivateKey();
            const address = deriveAddress(privateKey);
            
            return {
                address,
                privateKey,
                password,
                createdAt: new Date().toISOString()
            };
        }

        async function importWalletFromPrivateKey(privateKey, password) {
            if (!isValidPrivateKey(privateKey)) {
                throw new Error('Chave privada inválida');
            }
            
            const address = deriveAddress(privateKey);
            
            return {
                address,
                privateKey,
                password,
                imported: true,
                createdAt: new Date().toISOString()
            };
        }

        async function getETHBalance(address) {
            return (Math.random() * 10).toFixed(6);
        }

        async function getTokenBalance(address, tokenAddress) {
            return (Math.random() * 1000).toFixed(6);
        }

        async function sendTransaction(txData) {
            const txHash = '0x' + Math.random().toString(16).substr(2, 64);
            return { success: true, txHash };
        }

        function getStoredTokens(address) {
            try {
                const key = `tokens_${address}`;
                const tokens = localStorage.getItem(key);
                return tokens ? JSON.parse(tokens) : [];
            } catch (error) {
                return [];
            }
        }

        function addTokenToWallet(address, tokenData) {
            const key = `tokens_${address}`;
            const existingTokens = getStoredTokens(address);
            
            const exists = existingTokens.find(t => t.address === tokenData.address);
            if (exists) {
                throw new Error('Token já existe na carteira');
            }
            
            existingTokens.push(tokenData);
            localStorage.setItem(key, JSON.stringify(existingTokens));
        }

        async function getTokenInfo(address) {
            const mockTokens = {
                '0xa0b86a33e6c6c8f8b4de2a8c3c2d3f3c3b3a3b3a': {
                    name: 'USD Coin',
                    symbol: 'USDC',
                    decimals: 6
                }
            };
            
            return mockTokens[address] || null;
        }

        // Price Service
        const cryptoData = {
            BTC: { name: 'Bitcoin', price: 67234.50, change: 2.34 },
            ETH: { name: 'Ethereum', price: 3456.78, change: -0.87 },
            BNB: { name: 'Binance Coin', price: 589.23, change: 1.45 },
            ADA: { name: 'Cardano', price: 0.45, change: 3.21 },
            SOL: { name: 'Solana', price: 145.67, change: -2.11 },
            MATIC: { name: 'Polygon', price: 0.89, change: 4.56 },
            DOT: { name: 'Polkadot', price: 6.78, change: -1.23 },
            LINK: { name: 'Chainlink', price: 14.32, change: 2.87 }
        };

        function updatePrices() {
            Object.keys(cryptoData).forEach(symbol => {
                const variation = (Math.random() - 0.5) * 0.02;
                cryptoData[symbol].price *= (1 + variation);
                cryptoData[symbol].change = ((Math.random() - 0.5) * 10);
            });
        }

        async function getCurrentPrices() {
            await new Promise(resolve => setTimeout(resolve, 500));
            updatePrices();
            return { ...cryptoData };
        }

        setInterval(updatePrices, 10000);

        // React Components
        function LoginPage({ onLogin }) {
            const [password, setPassword] = React.useState('');
            const [confirmPassword, setConfirmPassword] = React.useState('');
            const [privateKey, setPrivateKey] = React.useState('');
            const [isImporting, setIsImporting] = React.useState(false);
            const [isLoading, setIsLoading] = React.useState(false);

            const handleCreateWallet = async (e) => {
                e.preventDefault();
                if (password.length < 6) {
                    alert('A senha deve ter pelo menos 6 caracteres');
                    return;
                }
                if (password !== confirmPassword) {
                    alert('As senhas não coincidem');
                    return;
                }

                setIsLoading(true);
                try {
                    await onLogin(password);
                } catch (error) {
                    alert('Erro ao criar carteira');
                } finally {
                    setIsLoading(false);
                }
            };

            const handleImportWallet = async (e) => {
                e.preventDefault();
                if (!privateKey.trim()) {
                    alert('Digite a chave privada');
                    return;
                }

                setIsLoading(true);
                try {
                    await onLogin(password, privateKey.trim());
                } catch (error) {
                    alert('Chave privada inválida');
                } finally {
                    setIsLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4">
                    <div className="glass-card p-8 w-full max-w-md">
                        <div className="text-center mb-8">
                            <div className="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                                <div className="icon-wallet text-white text-2xl"></div>
                            </div>
                            <h1 className="text-3xl font-bold mb-2">CryptoWallet</h1>
                            <p className="text-gray-300">Sua carteira digital segura</p>
                        </div>

                        <div className="mb-6">
                            <div className="flex rounded-lg bg-black bg-opacity-30 p-1">
                                <button
                                    onClick={() => setIsImporting(false)}
                                    className={`flex-1 py-2 px-4 rounded-md transition-all ${
                                        !isImporting ? 'bg-blue-600 text-white' : 'text-gray-300'
                                    }`}
                                >
                                    Criar Carteira
                                </button>
                                <button
                                    onClick={() => setIsImporting(true)}
                                    className={`flex-1 py-2 px-4 rounded-md transition-all ${
                                        isImporting ? 'bg-blue-600 text-white' : 'text-gray-300'
                                    }`}
                                >
                                    Importar
                                </button>
                            </div>
                        </div>

                        <form onSubmit={isImporting ? handleImportWallet : handleCreateWallet}>
                            {isImporting && (
                                <div className="mb-4">
                                    <label className="block text-sm font-medium mb-2">Chave Privada</label>
                                    <textarea
                                        value={privateKey}
                                        onChange={(e) => setPrivateKey(e.target.value)}
                                        placeholder="Cole sua chave privada aqui..."
                                        className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                                        rows={3}
                                        required
                                    />
                                </div>
                            )}

                            <div className="mb-4">
                                <label className="block text-sm font-medium mb-2">Senha</label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    placeholder="Digite uma senha segura"
                                    className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                                    required
                                    minLength={6}
                                />
                            </div>

                            {!isImporting && (
                                <div className="mb-6">
                                    <label className="block text-sm font-medium mb-2">Confirmar Senha</label>
                                    <input
                                        type="password"
                                        value={confirmPassword}
                                        onChange={(e) => setConfirmPassword(e.target.value)}
                                        placeholder="Confirme sua senha"
                                        className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                                        required
                                    />
                                </div>
                            )}

                            <button
                                type="submit"
                                disabled={isLoading}
                                className="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 py-3 rounded-lg font-semibold disabled:opacity-50 transition-all"
                            >
                                {isLoading ? 'Processando...' : 
                                 isImporting ? 'Importar Carteira' : 'Criar Carteira'}
                            </button>
                        </form>

                        <div className="mt-6 text-center text-xs text-gray-400">
                            Sua carteira é criptografada e armazenada localmente
                        </div>
                    </div>
                </div>
            );
        }

        function PriceWidget() {
            const [prices, setPrices] = React.useState({});
            const [loading, setLoading] = React.useState(true);

            React.useEffect(() => {
                loadPrices();
                const interval = setInterval(loadPrices, 30000);
                return () => clearInterval(interval);
            }, []);

            const loadPrices = async () => {
                try {
                    const cryptoPrices = await getCurrentPrices();
                    setPrices(cryptoPrices);
                } catch (error) {
                    console.error('Error loading prices:', error);
                } finally {
                    setLoading(false);
                }
            };

            const formatPrice = (price) => {
                return new Intl.NumberFormat('pt-BR', {
                    style: 'currency',
                    currency: 'USD',
                    minimumFractionDigits: 2
                }).format(price);
            };

            const getPriceColor = (change) => {
                return change >= 0 ? 'text-green-400' : 'text-red-400';
            };

            if (loading) {
                return (
                    <div className="price-widget rounded-lg p-4">
                        <h3 className="text-lg font-semibold mb-4 text-white">Cotações</h3>
                        <div className="animate-pulse space-y-3">
                            <div className="h-12 bg-white bg-opacity-10 rounded"></div>
                            <div className="h-12 bg-white bg-opacity-10 rounded"></div>
                            <div className="h-12 bg-white bg-opacity-10 rounded"></div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="price-widget rounded-lg p-4">
                    <div className="flex items-center justify-between mb-4">
                        <h3 className="text-lg font-semibold text-white">Cotações</h3>
                        <button 
                            onClick={loadPrices}
                            className="p-1 hover:bg-white hover:bg-opacity-20 rounded"
                        >
                            <div className="icon-refresh-cw text-white text-sm"></div>
                        </button>
                    </div>

                    <div className="space-y-3">
                        {Object.entries(prices).map(([symbol, data]) => (
                            <div key={symbol} className="flex items-center justify-between p-3 bg-white bg-opacity-5 rounded-lg">
                                <div className="flex items-center space-x-3">
                                    <div className="w-8 h-8 bg-gradient-to-br from-orange-500 to-yellow-600 rounded-full flex items-center justify-center">
                                        <span className="text-white font-bold text-xs">{symbol}</span>
                                    </div>
                                    <div>
                                        <div className="font-semibold text-white text-sm">{symbol}</div>
                                        <div className="text-xs text-gray-400">{data.name}</div>
                                    </div>
                                </div>
                                <div className="text-right">
                                    <div className="font-semibold text-white text-sm">
                                        {formatPrice(data.price)}
                                    </div>
                                    <div className={`text-xs ${getPriceColor(data.change)}`}>
                                        {data.change >= 0 ? '+' : ''}{data.change.toFixed(2)}%
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    <div className="mt-4 text-xs text-gray-400 text-center">
                        Última atualização: {new Date().toLocaleTimeString('pt-BR')}
                    </div>
                </div>
            );
        }

        function TokenBalance({ wallet }) {
            const [balances, setBalances] = React.useState({});
            const [loading, setLoading] = React.useState(true);

            const loadBalances = React.useCallback(async () => {
                try {
                    setLoading(true);
                    const ethBalance = await getETHBalance(wallet.address);
                    const tokens = getStoredTokens(wallet.address);
                    
                    const tokenBalances = {};
                    for (const token of tokens) {
                        const balance = await getTokenBalance(wallet.address, token.address);
                        tokenBalances[token.address] = { ...token, balance };
                    }

                    setBalances({
                        ETH: { symbol: 'ETH', name: 'Ethereum', balance: ethBalance, decimals: 18 },
                        ...tokenBalances
                    });
                } catch (error) {
                    console.error('Error loading balances:', error);
                } finally {
                    setLoading(false);
                }
            }, [wallet.address]);

            React.useEffect(() => {
                loadBalances();
            }, [loadBalances]);

            if (loading) {
                return (
                    <div className="glass-card p-6">
                        <div className="animate-pulse">
                            <div className="h-4 bg-white bg-opacity-20 rounded mb-4"></div>
                            <div className="space-y-3">
                                <div className="h-16 bg-white bg-opacity-10 rounded"></div>
                                <div className="h-16 bg-white bg-opacity-10 rounded"></div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="glass-card p-6">
                    <h2 className="text-xl font-semibold mb-4">Saldos dos Tokens</h2>
                    <div className="space-y-3">
                        {Object.values(balances).map((token, index) => (
                            <div key={index} className="flex items-center justify-between p-3 bg-black bg-opacity-20 rounded-lg">
                                <div className="flex items-center space-x-3">
                                    <div className="w-10 h-10 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-full flex items-center justify-center">
                                        <span className="text-white font-bold text-sm">
                                            {token.symbol.slice(0, 2)}
                                        </span>
                                    </div>
                                    <div>
                                        <div className="font-semibold">{token.symbol}</div>
                                        <div className="text-sm text-gray-300">{token.name}</div>
                                    </div>
                                </div>
                                <div className="text-right">
                                    <div className="font-semibold">
                                        {parseFloat(token.balance).toFixed(6)}
                                    </div>
                                    <div className="text-sm text-gray-300">{token.symbol}</div>
                                </div>
                            </div>
                        ))}
                    </div>
                    <button
                        onClick={loadBalances}
                        className="w-full mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center justify-center space-x-2"
                    >
                        <div className="icon-refresh-cw"></div>
                        <span>Atualizar Saldos</span>
                    </button>
                </div>
            );
        }

        function TransferForm({ wallet }) {
            const [toAddress, setToAddress] = React.useState('');
            const [amount, setAmount] = React.useState('');
            const [selectedToken, setSelectedToken] = React.useState('ETH');
            const [isLoading, setIsLoading] = React.useState(false);

            const handleTransfer = async (e) => {
                e.preventDefault();
                
                if (!toAddress || !amount) {
                    alert('Preencha todos os campos');
                    return;
                }

                if (!isValidAddress(toAddress)) {
                    alert('Endereço inválido');
                    return;
                }

                setIsLoading(true);
                try {
                    const result = await sendTransaction({
                        from: wallet.address,
                        to: toAddress,
                        amount: amount,
                        token: selectedToken,
                        privateKey: wallet.privateKey
                    });

                    if (result.success) {
                        alert(`Transferência enviada! Hash: ${result.txHash}`);
                        setToAddress('');
                        setAmount('');
                    } else {
                        alert('Erro na transferência: ' + result.error);
                    }
                } catch (error) {
                    alert('Erro na transferência: ' + error.message);
                } finally {
                    setIsLoading(false);
                }
            };

            return (
                <form onSubmit={handleTransfer} className="space-y-4">
                    <h3 className="text-lg font-semibold mb-4">Transferir Tokens</h3>
                    
                    <div>
                        <label className="block text-sm font-medium mb-2">Token</label>
                        <select
                            value={selectedToken}
                            onChange={(e) => setSelectedToken(e.target.value)}
                            className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white"
                        >
                            <option value="ETH">Ethereum (ETH)</option>
                            <option value="USDT">Tether USD (USDT)</option>
                            <option value="USDC">USD Coin (USDC)</option>
                        </select>
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Endereço de Destino</label>
                        <input
                            type="text"
                            value={toAddress}
                            onChange={(e) => setToAddress(e.target.value)}
                            placeholder="0x..."
                            className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Quantidade</label>
                        <input
                            type="number"
                            value={amount}
                            onChange={(e) => setAmount(e.target.value)}
                            placeholder="0.0"
                            step="0.000001"
                            className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                            required
                        />
                    </div>

                    <button
                        type="submit"
                        disabled={isLoading}
                        className="w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 py-3 rounded-lg font-semibold disabled:opacity-50 transition-all flex items-center justify-center space-x-2"
                    >
                        {isLoading ? (
                            <>
                                <div className="icon-loader animate-spin"></div>
                                <span>Enviando...</span>
                            </>
                        ) : (
                            <>
                                <div className="icon-send"></div>
                                <span>Transferir</span>
                            </>
                        )}
                    </button>

                    <div className="text-xs text-gray-400 mt-2">
                        ⚠️ Verifique o endereço antes de enviar. Transações não podem ser revertidas.
                    </div>
                </form>
            );
        }

        function ImportToken({ wallet }) {
            const [tokenAddress, setTokenAddress] = React.useState('');
            const [tokenSymbol, setTokenSymbol] = React.useState('');
            const [tokenName, setTokenName] = React.useState('');
            const [tokenDecimals, setTokenDecimals] = React.useState(18);
            const [isLoading, setIsLoading] = React.useState(false);

            const handleImportToken = async (e) => {
                e.preventDefault();
                
                if (!tokenAddress || !tokenSymbol || !tokenName) {
                    alert('Preencha todos os campos obrigatórios');
                    return;
                }

                if (!isValidAddress(tokenAddress)) {
                    alert('Endereço do token inválido');
                    return;
                }

                setIsLoading(true);
                try {
                    const tokenData = {
                        address: tokenAddress,
                        symbol: tokenSymbol.toUpperCase(),
                        name: tokenName,
                        decimals: tokenDecimals
                    };

                    addTokenToWallet(wallet.address, tokenData);
                    
                    alert(`Token ${tokenSymbol} importado com sucesso!`);
                    setTokenAddress('');
                    setTokenSymbol('');
                    setTokenName('');
                    setTokenDecimals(18);
                } catch (error) {
                    alert('Erro ao importar token: ' + error.message);
                } finally {
                    setIsLoading(false);
                }
            };

            const handleAutoFill = async () => {
                if (!tokenAddress || !isValidAddress(tokenAddress)) {
                    alert('Digite um endereço válido primeiro');
                    return;
                }

                setIsLoading(true);
                try {
                    const tokenInfo = await getTokenInfo(tokenAddress);
                    if (tokenInfo) {
                        setTokenSymbol(tokenInfo.symbol);
                        setTokenName(tokenInfo.name);
                        setTokenDecimals(tokenInfo.decimals);
                    }
                } catch (error) {
                    alert('Não foi possível obter informações do token');
                } finally {
                    setIsLoading(false);
                }
            };

            return (
                <form onSubmit={handleImportToken} className="space-y-4">
                    <h3 className="text-lg font-semibold mb-4">Importar Token Personalizado</h3>
                    
                    <div>
                        <label className="block text-sm font-medium mb-2">Endereço do Contrato *</label>
                        <div className="flex space-x-2">
                            <input
                                type="text"
                                value={tokenAddress}
                                onChange={(e) => setTokenAddress(e.target.value)}
                                placeholder="0x..."
                                className="flex-1 px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                                required
                            />
                            <button
                                type="button"
                                onClick={handleAutoFill}
                                className="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-colors"
                            >
                                <div className="icon-search text-sm"></div>
                            </button>
                        </div>
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Símbolo *</label>
                        <input
                            type="text"
                            value={tokenSymbol}
                            onChange={(e) => setTokenSymbol(e.target.value)}
                            placeholder="ETH"
                            className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Nome *</label>
                        <input
                            type="text"
                            value={tokenName}
                            onChange={(e) => setTokenName(e.target.value)}
                            placeholder="Ethereum"
                            className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white placeholder-gray-400"
                            required
                        />
                    </div>

                    <div>
                        <label className="block text-sm font-medium mb-2">Decimais</label>
                        <input
                            type="number"
                            value={tokenDecimals}
                            onChange={(e) => setTokenDecimals(parseInt(e.target.value))}
                            min="0"
                            max="18"
                            className="w-full px-3 py-2 bg-black bg-opacity-30 border border-gray-600 rounded-lg text-white"
                        />
                    </div>

                    <button
                        type="submit"
                        disabled={isLoading}
                        className="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 py-3 rounded-lg font-semibold disabled:opacity-50 transition-all flex items-center justify-center space-x-2"
                    >
                        {isLoading ? (
                            <>
                                <div className="icon-loader animate-spin"></div>
                                <span>Importando...</span>
                            </>
                        ) : (
                            <>
                                <div className="icon-plus"></div>
                                <span>Importar Token</span>
                            </>
                        )}
                    </button>
                </form>
            );
        }

        function WalletDashboard({ wallet, onLogout, currentView, setCurrentView }) {
            const [showPrivateKey, setShowPrivateKey] = React.useState(false);

            const copyToClipboard = (text) => {
                navigator.clipboard.writeText(text);
                alert('Copiado para a área de transferência!');
            };

            return (
                <div className="min-h-screen">
                    <header className="glass-card m-4 p-4">
                        <div className="flex justify-between items-center">
                            <div className="flex items-center space-x-4">
                                <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
                                    <div className="icon-wallet text-white"></div>
                                </div>
                                <h1 className="text-xl font-bold">CryptoWallet</h1>
                            </div>
                            <button
                                onClick={onLogout}
                                className="flex items-center space-x-2 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors"
                            >
                                <div className="icon-log-out"></div>
                                <span>Sair</span>
                            </button>
                        </div>
                    </header>

                    <div className="flex flex-col lg:flex-row gap-4 mx-4">
                        <div className="flex-1 space-y-4">
                            <div className="wallet-card p-6">
                                <h2 className="text-xl font-semibold mb-4">Informações da Carteira</h2>
                                <div className="space-y-3">
                                    <div>
                                        <label className="text-sm text-gray-300">Endereço</label>
                                        <div className="flex items-center space-x-2">
                                            <span className="font-mono text-sm bg-black bg-opacity-30 px-3 py-1 rounded">
                                                {wallet.address.slice(0, 20)}...
                                            </span>
                                            <button
                                                onClick={() => copyToClipboard(wallet.address)}
                                                className="p-1 hover:bg-white hover:bg-opacity-20 rounded"
                                            >
                                                <div className="icon-copy text-sm"></div>
                                            </button>
                                        </div>
                                    </div>
                                    <div>
                                        <label className="text-sm text-gray-300">Chave Privada</label>
                                        <div className="flex items-center space-x-2">
                                            <span className="font-mono text-sm bg-black bg-opacity-30 px-3 py-1 rounded">
                                                {showPrivateKey ? wallet.privateKey : '••••••••••••••••'}
                                            </span>
                                            <button
                                                onClick={() => setShowPrivateKey(!showPrivateKey)}
                                                className="p-1 hover:bg-white hover:bg-opacity-20 rounded"
                                            >
                                                <div className={`icon-${showPrivateKey ? 'eye-off' : 'eye'} text-sm`}></div>
                                            </button>
                                            <button
                                                onClick={() => copyToClipboard(wallet.privateKey)}
                                                className="p-1 hover:bg-white hover:bg-opacity-20 rounded"
                                            >
                                                <div className="icon-copy text-sm"></div>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <TokenBalance wallet={wallet} />

                            <div className="glass-card p-4">
                                <div className="flex space-x-2 mb-6">
                                    <button
                                        onClick={() => setCurrentView('transfer')}
                                        className={`px-4 py-2 rounded-lg transition-colors ${
                                            currentView === 'transfer' ? 'bg-blue-600' : 'bg-black bg-opacity-30'
                                        }`}
                                    >
                                        Transferir
                                    </button>
                                    <button
                                        onClick={() => setCurrentView('import')}
                                        className={`px-4 py-2 rounded-lg transition-colors ${
                                            currentView === 'import' ? 'bg-blue-600' : 'bg-black bg-opacity-30'
                                        }`}
                                    >
                                        Importar Token
                                    </button>
                                </div>

                                {currentView === 'transfer' && <TransferForm wallet={wallet} />}
                                {currentView === 'import' && <ImportToken wallet={wallet} />}
                            </div>
                        </div>

                        <div className="lg:w-80">
                            <PriceWidget />
                        </div>
                    </div>
                </div>
            );
        }

        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false };
            }

            static getDerivedStateFromError(error) {
                return { hasError: true };
            }

            componentDidCatch(error, errorInfo) {
                console.error('Wallet app error:', error, errorInfo);
            }

            render() {
                if (this.state.hasError) {
                    return (
                        <div className="min-h-screen flex items-center justify-center">
                            <div className="glass-card p-8 text-center">
                                <h2 className="text-2xl font-bold text-red-400 mb-4">Erro na Carteira</h2>
                                <button 
                                    onClick={() => window.location.reload()}
                                    className="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg"
                                >
                                    Recarregar
                                </button>
                            </div>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        function App() {
            const [isLoggedIn, setIsLoggedIn] = React.useState(false);
            const [wallet, setWallet] = React.useState(null);
            const [currentView, setCurrentView] = React.useState('dashboard');

            React.useEffect(() => {
                const savedWallet = localStorage.getItem('cryptoWallet');
                if (savedWallet) {
                    setWallet(JSON.parse(savedWallet));
                    setIsLoggedIn(true);
                }
            }, []);

            const handleLogin = async (password, privateKey = null) => {
                try {
                    let walletData;
                    if (privateKey) {
                        walletData = await importWalletFromPrivateKey(privateKey, password);
                    } else {
                        walletData = await createWallet(password);
                    }
                    
                    setWallet(walletData);
                    setIsLoggedIn(true);
                    localStorage.setItem('cryptoWallet', JSON.stringify(walletData));
                } catch (error) {
                    alert('Erro ao fazer login: ' + error.message);
                }
            };

            const handleLogout = () => {
                setIsLoggedIn(false);
                setWallet(null);
                localStorage.removeItem('cryptoWallet');
            };

            if (!isLoggedIn) {
                return <LoginPage onLogin={handleLogin} />;
            }

            return (
                <div className="min-h-screen">
                    <WalletDashboard 
                        wallet={wallet}
                        onLogout={handleLogout}
                        currentView={currentView}
                        setCurrentView={setCurrentView}
                    />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <ErrorBoundary>
                <App />
            </ErrorBoundary>
        );
    </script>
</body>
</html>
